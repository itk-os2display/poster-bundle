/**
 * @name PosterBundle
 * @version v1.0.0
 * @link https://github.com/itk-os2display/poster-bundle
 */
angular.module("posterModule",[]),angular.module("posterModule").config([function(){}]),angular.module("posterModule").directive("posterTool",["$timeout","$http",function(r,s){"use strict";return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(a){a.typeSelect="searchName",a.searchName="",a.searchUrl="",a.pagerBack=function(){a.pager.centerItem=Math.max(a.pager.centerItem-10,1)},a.pagerForward=function(){a.pager.centerItem=Math.min(a.pager.centerItem+10,a.pager.pagerMax)},a.getPagerPages=function(){a.pager.pages=[];for(var e=parseInt(a.pager.centerItem/10),t=1;t<=10;t++)t+10*e<=a.pager.pagerMax&&a.pager.pages.push(t+10*e);return a.pager.pages},a.calculatePager=function(e){e&&(a.pager={pages:[],currentPage:e.page,pagerMax:e.number_of_pages,itemsPerPage:e.items_per_page,totalResults:e.total_results,centerItem:e.page})},a.search=function(e){a.displayEvent=null,a.events=null;var t={};e&&(t.page=e),"searchName"===a.typeSelect?t.name=a.searchName:"searchUrl"===a.typeSelect&&(t.url=a.searchUrl),s.get("/api/os2display_poster/events",{params:t}).then(function(e){r(function(){a.events=e.data.events,a.meta=e.data.meta,a.calculatePager(a.meta)})})},a.clickEvent=function(e){a.displayEvent=e,1===a.displayEvent.occurrences.length&&a.clickOccurrence(a.displayEvent.occurrences[0])},a.refreshEvent=function(){s.get("/api/os2display_poster/occurrence",{params:{occurrenceId:a.slide.options.data.occurrenceId}}).then(function(e){r(function(){a.slide.options.data=e.data})})},a.clickOccurrence=function(e){s.get("/api/os2display_poster/occurrence",{params:{occurrenceId:e["@id"]}}).then(function(t){r(function(){if(a.slide.options.data=t.data,a.slide.options.data.endDate){var e=new Date(a.slide.options.data.endDate).getTime();a.slide.schedule_to=parseInt(e/1e3)}})}),a.close()}},templateUrl:"/bundles/os2displayposter/apps/posterModule/posterTool.html"}}]),angular.module("posterModule").directive("posterEditTextsTool",[function(){"use strict";return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(e){e.slide.options.overrides||(e.slide.options.overrides={})},templateUrl:"/bundles/os2displayposter/apps/posterModule/posterEditTextsTool.html"}}]);